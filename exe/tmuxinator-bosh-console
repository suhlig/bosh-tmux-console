#!/usr/bin/env ruby
# frozen_string_literal: true

$LOAD_PATH.unshift(File.expand_path('../../lib', __FILE__))

require 'pathname'

def die(msg)
  warn "Error: #{msg}"
  exit(1)
end

require 'tmuxinator/bosh/console/director_gateway'
require 'tmuxinator/bosh/console/template'
include Tmuxinator::BOSH::Console

instances = DirectorGateway.new.instances

project_name = ARGV.first || die('Missing argument for the tmuxinator project name')
project_file = Pathname("~/.tmuxinator/#{project_name}.yml").expand_path

if project_file.exist?
  die("Not overriding tmuxinator project file #{project_file}")
end

template = Template.new(Pathname(__dir__) / '../templates/bosh-console.yml')
project_file.write(template.render(binding))
